<!doctype html>
<html>

<head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>Projeto Protetor Animal</title>
    <link href='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css' rel='stylesheet'>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet'>
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
    <script src="https://smtpjs.com/v3/smtp.js">
    </script>
    <style>
        ::-webkit-scrollbar {
            width: 8px;
        }

        /* Track */
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        /* Handle */
        ::-webkit-scrollbar-thumb {
            background: #888;
        }

        /* Handle on hover */
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        body {
            background: #eee
        }

        #regForm {
            background-color: #ffffff;
            margin: 0px auto;
            font-family: Raleway;
            padding: 40px;
            border-radius: 10px
        }

        #register {

            color: #6A1B9A;
        }

        h1 {
            text-align: center
        }

        .input>input {
            padding: 10px;
            width: 100%;
            font-size: 17px;
            font-family: Raleway;
            border: 1px solid #aaaaaa;
            border-radius: 10px;
            -webkit-appearance: none;
        }



        .tab input:focus {

            border: 1px solid #6a1b9a !important;
            outline: none;
        }

        input.invalid {

            border: 1px solid #e03a0666;
        }

        .tab {
            display: none
        }

        button {
            background-color: #6A1B9A;
            color: #ffffff;
            border: none;
            border-radius: 50%;
            padding: 10px 20px;
            font-size: 17px;
            font-family: Raleway;
            cursor: pointer
        }

        button:hover {
            opacity: 0.8
        }

        button:focus {

            outline: none !important;
        }

        #prevBtn {
            background-color: #bbbbbb
        }


        .all-steps {
            text-align: center;
            margin-top: 30px;
            margin-bottom: 30px;
            width: 100%;
            display: inline-flex;
            justify-content: center;
        }

        .step {
            height: 40px;
            width: 40px;
            margin: 0 2px;
            background-color: #bbbbbb;
            border: none;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 15px;
            color: #6a1b9a;
            opacity: 0.5;
        }

        .step.active {
            opacity: 1
        }


        .step.finish {
            color: #fff;
            background: #6a1b9a;
            opacity: 1;

        }



        .all-steps {
            text-align: center;
            margin-top: 30px;
            margin-bottom: 30px
        }

        .thanks-message {
            display: none
        }
    </style>
</head>

<body className='snippet-body'>
    <div class="container mt-5">
        <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-8">
                <form id="regForm">
                    <h1 id="register">Projeto Protetor Animal</h1>
                    <div class="all-steps" id="all-steps">
                        <span class="step"><i class="fa fa-info"></i></span>
                        <span class="step"><i class="fa fa-user"></i></span>
                        <span class="step"><i class="fa fa-map-marker"></i></span>
                        <span class="step"><i class="fa fa-car"></i></span>
                    </div>

                    <div class="tab">
                        <h5 class="text-center">Informativo</h5>
                        <p>
                            Apesar de que alguns alguns Estados e Municípios possuam Leis específicas em relação a isso,
                            no geral, são considerados maus-tratos aos animais domésticos, como cães e gatos:
                        </p>
                        <ul>
                            <li>Abandonar</li>
                            <li>Não oferecer assistência médica-veterinária</li>
                            <li>Agressões físicas</li>
                            <li>Manter o animal preso a correntes ou cordas</li>
                            <li>Deixar o animal exposto ao sol por longos períodos de tempo</li>
                            <li>Manter o animal em locais não-arejados (sem ventilação ou entrada de luz)</li>
                            <li>Manter os pets em lugares anti-higiênicos</li>
                            <li>Submeter o animal a tarefas exaustivas ou além de suas forças</li>
                            <li>Usar animais em espetáculos que possam submetê-los a pânico ou estresse</li>
                        </ul>
                        <p class="text-center">
                            <input class="form-check-input" type="checkbox" oninput="changeCheckLi()"
                                aria-label="Checkbox for following text input">
                            <label for="check"> Eu li e estou ciente do que constitui maus-tratos aos animais
                                domésticos. </label><br>
                        </p>


                    </div>
                    <div class="tab">
                        <h5>Suas Informações</h5>
                        <p class="input"><input placeholder="Nome" oninput="this.className = ''" id="nome"></p>
                        <p class="input"><input placeholder="Email" oninput="this.className = ''" id="email"></p>
                        <p class="input"><input placeholder="Telefone" oninput="this.className = ''" id="telefone"
                                onkeyup="this.value = this.value.replace(/[^0-9-]/g, '');"></p>
                        <p class="text-center">
                            <input class="form-check-input" type="checkbox" oninput="changeCheckAnonimo()"
                                aria-label="Checkbox for following text input">
                            <label for="check"> Fazer denuncia anônima.</label><br>
                        </p>
                    </div>
                    <div class="tab">
                        <h5>Que tipo de maus-tratos você deseja denunciar?</h5>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="abandono"
                                onclick="changeDenuncia('abandono')">
                            <label id="abandonolabel"> Abandono</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="medica"
                                onclick="changeDenuncia('medica')">
                            <label id="medicalabel"> Falta de assistência médica-veterinária</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="agressao"
                                onclick="changeDenuncia('agressao')">
                            <label id="agressaolabel"> Agressões físicas</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="preso"
                                onclick="changeDenuncia('preso')">
                            <label id="presolabel"> Manter o animal preso a correntes ou cordas</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="sol" onclick="changeDenuncia('sol')">
                            <label id="sollabel"> Deixar o animal exposto ao sol por longos períodos de tempo</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="arejados"
                                onclick="changeDenuncia('arejados')">
                            <label id="arejadoslabel"> Manter o animal em locais não-arejados (sem ventilação ou entrada
                                de
                                luz)</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="higienico"
                                onclick="changeDenuncia('higienico')">
                            <label id="higienicolabel"> Manter os pets em lugares anti-higiênicos</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="tarefas"
                                onclick="changeDenuncia('tarefas')">
                            <label id="tarefaslabel"> Submeter o animal a tarefas exaustivas ou além de suas
                                forças</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="estresse"
                                onclick="changeDenuncia('estresse')">
                            <label id="estresselabel"> Usar animais em espetáculos que possam submetê-los a pânico ou
                                estresse</label>
                        </p>

                        <p>
                            <input class="form-check-input" type="checkbox"
                                aria-label="Checkbox for following text input" id="outro"
                                onclick="changeDenuncia('outro')">
                            <label id="outrolabel"> Outro</label>
                        </p>

                        <div class="form-floating">
                            <textarea class="form-control" placeholder="Deixe mais alguma descrição" id="textDescricao"
                                style="height: 100px"></textarea>
                        </div>
                        <br>
                    </div>
                    <div class="tab">
                        <h5>Endereço da denúncia</h5>
                        <p class="input"><input placeholder="CEP" oninput="this.className = ''; actionCEP()"
                                id="textCEP" name="uname">
                        <p class="input"><input placeholder="Estado" disabled value="RS">
                        <p class="input"><input placeholder="Cidade" disabled value="Canoas">
                        <p class="input"><input placeholder="Rua" oninput="this.className = ''" onblur="actionRua();"
                                id="textRua" name="uname">
                        <p class="input"><input id="textNumero" placeholder="Número" oninput="this.className = ''"
                                name="uname">
                        <p class="input"><input id="textComplemento" placeholder="Complemento">
                        </p>
                    </div>
                    <div class="thanks-message text-center" id="text-message"> <img
                            src="https://i.imgur.com/O18mJ1K.png" width="100" class="mb-4">
                        <h3>Obrigado pela sua denuncia!</h3> <span>Obrigado por fazer a sua parte pela proteção dos
                            animais domésticos.</span>
                    </div>
                    <div style="overflow:auto;" id="nextprevious">
                        <div style="float:right;">
                            <button type="button" id="prevBtn" onclick="nextPrev(-1)"><i
                                    class="fa fa-angle-double-left"></i></button>
                            <button type="button" class="disabled" id="nextBtn" onclick="nextPrev(1)"><i
                                    class="fa fa-angle-double-right"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type='text/javascript'
        src='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js'></script>
    <script type='text/javascript' src='#'></script>
    <script type='text/javascript' src='#'></script>
    <script type='text/javascript' src='#'></script>
    <script type='text/javascript'>var myLink = document.querySelector('a[href="#"]');
        myLink.addEventListener('click', function (e) {
            e.preventDefault();
        });</script>
    <script type='text/javascript'>
        var currentTab = 0;
        var checkLi = false;
        var checkAnonimo = false;
        var abandono = false;
        var medica = false;
        var agressao = false;
        var preso = false;
        var sol = false;
        var arejados = false;
        var higienico = false;
        var tarefas = false;
        var estresse = false;
        var outro = false;
        var textCEP = document.getElementById('textCEP');
        var textRua = document.getElementById('textRua');
        document.addEventListener("DOMContentLoaded", function (event) {


            showTab(currentTab);

        });

        function changeCheckLi() {
            checkLi = !checkLi
        }

        function changeCheckAnonimo() {
            checkAnonimo = !checkAnonimo
            var inputNome = document.getElementById("nome")
            var inputEmail = document.getElementById("email")
            var inputTelefone = document.getElementById("telefone")
            if (checkAnonimo == true) {
                inputNome.value = ''
                inputNome.disabled = true;
                inputEmail.value = ''
                inputEmail.disabled = true;
                inputTelefone.value = ''
                inputTelefone.disabled = true;
            }
            else {
                inputNome.disabled = false;
                inputEmail.disabled = false;
                inputTelefone.disabled = false;
            }
        }

        function changeDenuncia(tipo) {
            switch (tipo) {
                case 'abandono':
                    abandono = !abandono
                    break;
                case 'medica':
                    medica = !medica
                    break;
                case 'agressao':
                    agressao = !agressao
                    break;
                case 'preso':
                    preso = !preso
                    break;
                case 'sol':
                    sol = !sol
                    break;
                case 'arejados':
                    arejados = !arejados
                    break;
                case 'higienico':
                    higienico = !higienico
                    break;
                case 'tarefas':
                    tarefas = !tarefas
                    break;
                case 'estresse':
                    estresse = !estresse
                    break;
                case 'outro':
                    outro = !outro
                    break;
                default:
                    break;
            };
        }

        function checkMausTratos() {
            if (
                abandono == false && medica == false &&
                agressao == false && preso == false &&
                sol == false && arejados == false &&
                higienico == false && estresse == false &&
                outro == false
            ) {
                console.log('aqui 1')
                alert("Selecione ao menos um dos tipos de maus-tratos")
                return false
            }
            if (outro == true && document.getElementById("textDescricao").value == '') {
                console.log('aqui 2')
                alert("Preencha o campo descrição com mais informações do tipo de outros maus-tratos")
                return false
            }
            console.log('aqui 3')
            return true
        }

        function showTab(n) {
            var x = document.getElementsByClassName("tab");
            x[n].style.display = "block";
            if (n == 0) {
                document.getElementById("prevBtn").style.display = "none";
            } else {
                document.getElementById("prevBtn").style.display = "inline";
            }
            if (n == (x.length - 1)) {
                document.getElementById("nextBtn").innerHTML = '<i class="fa fa-angle-double-right"></i>';
            } else {
                document.getElementById("nextBtn").innerHTML = '<i class="fa fa-angle-double-right"></i>';
            }
            fixStepIndicator(n)
        }

        function nextPrev(n) {
            if (checkLi == false) {
                return
            }
            var x = document.getElementsByClassName("tab");
            if (currentTab == 1 && n == 1 && !validateFormPessoa()) return false;
            if (currentTab == 2 && n == 1 && !checkMausTratos()) {
                console.log('aqui 4')
                return false};
            x[currentTab].style.display = "none";
            currentTab = currentTab + n;
            if (currentTab >= x.length) {

                document.getElementById("nextprevious").style.display = "none";
                document.getElementById("all-steps").style.display = "none";
                document.getElementById("register").style.display = "none";
                document.getElementById("text-message").style.display = "block";
                sendMail();

            }
            console.log();
            showTab(currentTab);
        }

        function validateFormPessoa() {
            var x, y, i, valid = true;
            x = document.getElementsByClassName("tab");
            y = x[currentTab].getElementsByTagName("input");
            if (currentTab == 1) {
                if (checkAnonimo == true) {
                    return valid;
                }
                var inputNome = document.getElementById("nome")
                var inputEmail = document.getElementById("email")
                var inputTelefone = document.getElementById("telefone")
                if (inputNome.value == "") inputNome.className += " invalid";
                if (inputEmail.value == "") inputEmail.className += " invalid";
                if (inputTelefone.value == "") inputTelefone.className += " invalid";
            }
            for (i = 0; i < y.length; i++) {
                if (y[i].value == "") {
                    y[i].className += " invalid";
                    valid = false;
                }


            }
            if (valid) {
                document.getElementsByClassName("step")[currentTab].className += " finish";
            }
            return valid;
        }

        function fixStepIndicator(n) {
            var i, x = document.getElementsByClassName("step");
            for (i = 0; i < x.length; i++) {
                x[i].className = x[i].className.replace(" active", "");
            }
            x[n].className += " active";
        }

        function actionCEP() {
            var cep = textCEP.value;
            if (cep.length == 8)
                pesquisarCEP(cep);
            else if (cep.length > 8)
                textCEP.value = cep.slice(0, 8);
        }

        function pesquisarCEP(cep) {
            var url = 'https://viacep.com.br/ws/' + cep + '/json/';
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                console.log(this.readyState); //estado 4 significa comunicação finalizada
                console.log(this.status); //status da resposta http (200, 400, 500...)
                console.log(this.response);
                if (this.readyState == 4 && this.status == 200) {
                    var resposta = JSON.parse(this.response);
                    console.log(resposta);
                    if (resposta.erro) {
                        console.log('Cep não encontrado!');
                        textRua.value = '';
                    } else {
                        console.log('Cep encontrado!');
                        textRua.value = resposta.logradouro;
                    }
                }
            };
            xhttp.open('GET', url, true);
            xhttp.send();
        }

        function actionRua() {
            var rua = textRua.value;
            console.log('Pesquisando rua ... ')
            if (rua.length >= 4) {
                pesquisarRua(rua.replace(" ", "+"));
            }
        }

        function pesquisarRua(rua) {
            var url = 'https://viacep.com.br/ws/RS/Canoas/' + rua + '/json/';
            console.log(rua)
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                console.log(this.readyState); //estado 4 significa comunicação finalizada
                console.log(this.status); //status da resposta http (200, 400, 500...)
                console.log(this.response);
                if (this.readyState == 4 && this.status == 200) {
                    var resposta = JSON.parse(this.response);
                    console.log(resposta);
                    if (resposta.erro) {
                        console.log('Rua não encontrado!');
                        textCEP.value = '';
                    } else {
                        if (resposta.length == 1) {
                            console.log('Rua encontrado!');
                            textCEP.value = resposta[0].cep.replace("-", "");
                            textRua.value = resposta[0].logradouro;
                        }
                    }
                }
            };
            xhttp.open('GET', url, true);
            xhttp.send();
        }

        function sendMail() {
            const myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");
            myHeaders.set('Authorization', 'Basic ' + btoa('a5d281e10c073dd85b64ee3f6010bc22' + ":" + 'a535dce95239c85ac85652e5a6e20d72'));
            var currentdate = new Date();
            var datetime = currentdate.getDate() + "/"
                + (currentdate.getMonth() + 1) + "/"
                + currentdate.getFullYear() + " @ "
                + currentdate.getHours() + ":"
                + ('0'+currentdate.getMinutes()).slice(-2);
            var message = 'Denúncia ' +  datetime + '</br></br>\n'
            message += 'Dados Pessoais:\n'
            if (checkAnonimo == true) {
                 message += 'Anônimo</br></br>\n'
            } else {
                 message += 'Nome: ' + document.getElementById("nome").value + '</br>\n'
                 message += 'Email: ' + document.getElementById("email").value + '</br>\n'
                 message += 'Telefone: ' + document.getElementById("telefone").value + '</br></br>\n'
            }
             message += 'Tipos de maus-tratos:</br>\n'
            if (abandono == true) {
                 message += ' - ' + document.getElementById("abandonolabel").innerText + '</br>\n'
            }
            if (medica == true) {
                 message += ' - ' + document.getElementById("medicalabel").innerText + '</br>\n'
            }
            if (agressao == true) {
                 message += ' - ' + document.getElementById("agressaolabel").innerText + '</br>\n'
            }
            if (preso == true) {
                 message += ' - ' + document.getElementById("presolabel").innerText + '</br>\n'
            }
            if (sol == true) {
                 message += ' - ' + document.getElementById("sollabel").innerText + '</br>\n'
            }
            if (arejados == true) {
                 message += ' - ' + document.getElementById("arejadoslabel").innerText + '</br>\n'
            }
            if (higienico == true) {
                 message += ' - ' + document.getElementById("higienicolabel").innerText + '</br>\n'
            }
            if (tarefas == true) {
                 message += ' - ' + document.getElementById("tarefaslabel").innerText + '</br>\n'
            }
            if (estresse == true) {
                 message += ' - ' + document.getElementById("estresselabel").innerText + '</br>\n'
            }
            if (outro == true) {
                 message += ' - ' + document.getElementById("outrolabel").innerText + '</br>\n'
            }
             message += 'Descrição: ' + document.getElementById("textDescricao").value + '</br></br>\n'
             message += 'Endereço da denúncia \n'
             message += 'CEP: ' + document.getElementById("textCEP").value + '</br>\n'
             message += 'Rua: ' + document.getElementById("textRua").value + '</br>\n'
             message += 'Número: ' + document.getElementById("textNumero").value + '</br>\n'
             message += 'Complemento: ' + document.getElementById("textComplemento").value + '</br>\n'

            Email.send({
                SecureToken: "c96a15a2-0e1e-4a48-b8f3-546c8507381c",
                To: 'projetoprotetoranimal@gmail.com',
                From: "projetoprotetoranimal@gmail.com",
                Subject: "Denúncia " + datetime,
                Body: message
            });
        }

    </script>

</body>

</html>
